<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë‹¨ì–´ì„¤ëª… í€´ì¦ˆ (ë‹¤ì¸ìš©)</title>
<style>
body {
  font-family: "Pretendard", sans-serif;
  background-color: #f8fafc;
  color: #333;
  text-align: center;
  margin: 0;
  padding: 20px;
}
h1 {
  color: #0072e3;
}
button {
  background-color: #0072e3;
  color: white;
  border: none;
  border-radius: 8px;
  padding: 10px 20px;
  margin: 10px;
  cursor: pointer;
}
button:hover {
  background-color: #005bb5;
}
input, textarea {
  width: 90%;
  padding: 8px;
  border-radius: 6px;
  border: 1px solid #ccc;
  margin: 8px 0;
}
#game, #explanationInput, #guessInput, #result, #endGame { display: none; }
.timer { font-size: 1.5em; color: #d6336c; }
.explanation-list {
  background: #fff;
  border-radius: 8px;
  padding: 10px;
  max-width: 400px;
  margin: 0 auto;
  text-align: left;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}
</style>
</head>
<body>

<h1>ğŸ® ë‹¨ì–´ì„¤ëª… í€´ì¦ˆ (ë‹¤ì¸ìš©)</h1>

<div id="setup">
  <p>í”Œë ˆì´ì–´ ì´ë¦„ì„ 3~5ëª… ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
  <div id="playerInputs"></div>
  <button onclick="addPlayer()">+ í”Œë ˆì´ì–´ ì¶”ê°€</button>
  <button onclick="startGame()">ê²Œì„ ì‹œì‘</button>
</div>

<div id="game">
  <h2 id="roundInfo"></h2>
  <p id="wordDisplay" style="font-size:1.3em;"></p>
  <p class="timer" id="timer"></p>
  
  <div id="explanationInput">
    <p><strong id="currentPlayerName"></strong>ë‹˜, ë‹¨ì–´ë¥¼ ì¼ë³¸ì–´ë¡œ ì„¤ëª…í•´ì£¼ì„¸ìš”!</p>
    <textarea id="explanationText"></textarea><br>
    <button onclick="submitExplanation()">ì„¤ëª… ì œì¶œ</button>
  </div>

  <div id="guessInput">
    <h3>ğŸ“ ì„¤ëª… ë¦¬ìŠ¤íŠ¸</h3>
    <div class="explanation-list" id="explanationList"></div>
    <p>í”Œë ˆì´ì–´ <strong id="guesserName"></strong>ë‹˜, ì •ë‹µì„ ì…ë ¥í•˜ì„¸ìš” (15ì´ˆ ì œí•œ)</p>
    <input type="text" id="guessAnswer" placeholder="ì •ë‹µ ì…ë ¥">
    <button onclick="submitGuess()">ì •ë‹µ ì œì¶œ</button>
  </div>

  <div id="result">
    <h3 id="resultText"></h3>
    <button onclick="nextRound()">ë‹¤ìŒ ë¼ìš´ë“œ</button>
  </div>
</div>

<div id="endGame">
  <h2>ğŸ‰ ê²Œì„ ì¢…ë£Œ!</h2>
  <div id="scoreBoard"></div>
</div>

<script>
let players = [];
let currentRound = 0;
let currentWord = "";
let explanations = {};
let wordList = ["çŒ«", "å­¦æ ¡", "é›»è»Š", "å…ˆç”Ÿ", "æ–™ç†", "æ˜ ç”»", "å‹é”", "æ—¥æœ¬èª", "å‹‰å¼·", "æ¡œ"];
let timerInterval;
let scores = {};

function addPlayer() {
  const div = document.createElement("div");
  div.innerHTML = '<input class="player-input" type="text" placeholder="í”Œë ˆì´ì–´ ì´ë¦„">';
  document.getElementById("playerInputs").appendChild(div);
}

function startGame() {
  const inputs = document.querySelectorAll(".player-input");
  players = Array.from(inputs).map(i => i.value.trim()).filter(v => v);
  if (players.length < 3 || players.length > 5) {
    alert("í”Œë ˆì´ì–´ëŠ” 3~5ëª…ì´ì–´ì•¼ í•©ë‹ˆë‹¤!");
    return;
  }
  players.forEach(p => scores[p] = 0);
  document.getElementById("setup").style.display = "none";
  document.getElementById("game").style.display = "block";
  startRound();
}

function startRound() {
  if (currentRound >= players.length) {
    endGame();
    return;
  }
  explanations = {};
  currentWord = wordList[Math.floor(Math.random() * wordList.length)];
  document.getElementById("roundInfo").innerText = `ë¼ìš´ë“œ ${currentRound+1}: ${players[currentRound]}ë‹˜ì´ ì •ë‹µì!`;
  document.getElementById("wordDisplay").innerText = `ë‹¨ì–´: ${currentWord}`;
  startExplanationPhase();
}

function startExplanationPhase() {
  let i = 0;
  let explainerList = players.filter(p => p !== players[currentRound]);
  document.getElementById("explanationInput").style.display = "block";
  document.getElementById("guessInput").style.display = "none";
  document.getElementById("result").style.display = "none";
  startTimer(60, () => {
    if (Object.keys(explanations).length === 0) {
      alert("ì œì¶œëœ ì„¤ëª…ì´ ì—†ìŠµë‹ˆë‹¤. ìë™ìœ¼ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.");
    }
    startGuessPhase();
  });
  nextExplainer(explainerList, i);
}

function nextExplainer(list, index) {
  if (index >= list.length) return;
  document.getElementById("currentPlayerName").innerText = list[index];
  document.getElementById("explanationText").value = "";
  document.getElementById("explanationText").focus();
  document.querySelector("button[onclick='submitExplanation()']").onclick = () => {
    const text = document.getElementById("explanationText").value.trim();
    if (!text) return alert("ì„¤ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");
    explanations[list[index]] = text;
    nextExplainer(list, index + 1);
  };
}

function startGuessPhase() {
  document.getElementById("explanationInput").style.display = "none";
  document.getElementById("guessInput").style.display = "block";
  const guesser = players[currentRound];
  document.getElementById("guesserName").innerText = guesser;
  const listDiv = document.getElementById("explanationList");
  listDiv.innerHTML = "";
  for (const [player, exp] of Object.entries(explanations)) {
    const p = document.createElement("p");
    p.innerHTML = `<strong>${player}:</strong> ${exp}`;
    listDiv.appendChild(p);
  }
  startTimer(15, () => submitGuess());
}

function startTimer(seconds, callback) {
  clearInterval(timerInterval);
  const timerEl = document.getElementById("timer");
  timerEl.innerText = `${seconds}ì´ˆ`;
  timerInterval = setInterval(() => {
    seconds--;
    timerEl.innerText = `${seconds}ì´ˆ`;
    if (seconds <= 0) {
      clearInterval(timerInterval);
      callback();
    }
  }, 1000);
}

function submitExplanation() {}

function submitGuess() {
  clearInterval(timerInterval);
  const guesser = players[currentRound];
  const answer = document.getElementById("guessAnswer").value.trim();
  document.getElementById("guessInput").style.display = "none";
  document.getElementById("result").style.display = "block";
  if (answer === currentWord) {
    scores[guesser]++;
    document.getElementById("resultText").innerText = `ğŸ‰ ì •ë‹µ! (${answer})`;
  } else {
    document.getElementById("resultText").innerText = `âŒ ì˜¤ë‹µ! ì •ë‹µì€ '${currentWord}'`;
  }
}

function nextRound() {
  currentRound++;
  startRound();
}

function endGame() {
  document.getElementById("game").style.display = "none";
  document.getElementById("endGame").style.display = "block";
  let html = "<h3>ìµœì¢… ì ìˆ˜</h3><ul style='list-style:none'>";
  Object.entries(scores).forEach(([p, s]) => {
    html += `<li>${p}: ${s}ì </li>`;
  });
  html += "</ul>";
  document.getElementById("scoreBoard").innerHTML = html;
}
</script>
</body>
</html>
